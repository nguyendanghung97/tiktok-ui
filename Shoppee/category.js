
var listProducts = [
    {
        id: 1,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1200000,
        quantitySold: 70,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type: 'thomBrowne'
        }
    },
    {
        id: 2,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1200000,
        quantitySold: 60,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 3,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1200000,
        quantitySold: 50,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 4,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1500000,
        quantitySold: 38,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 5,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1600000,
        quantitySold: 31,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 6,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1000000,
        quantitySold: 35,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 7,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1500000,
        quantitySold: 37,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 8,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 900000,
        quantitySold: 30,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 9,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1200000,
        quantitySold: 30,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 10,
        name: 'Ví Da Nam Thom Browne Chính Hãng',
        price: 1000000,
        quantitySold: 50,
        image: 'https://i.pinimg.com/736x/5f/8d/36/5f8d3604d12118d1cf7ad995a59e26d3--well-dressed-men-thom-browne.jpg',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'thomBrowne'        
        }
    },
    {
        id: 11,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 1500000,
        quantitySold: 50,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'T-Shirt'        
        }
    },
    {
        id: 12,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 1200000,
        quantitySold: 100,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'dior'        
        }
    },
    {
        id: 13,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 1200000,
        quantitySold: 15,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'dior'        
        }
    },
    {
        id: 14,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 1200000,
        quantitySold: 20,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'dior'        
        }
    },
    {
        id: 15,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 900000,
        quantitySold: 40,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'dior'        
        }
    },
    {
        id: 16,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 1600000,
        quantitySold: 30,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'dior'        
        }
    },
    {
        id: 17,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 2000000,
        quantitySold: 10,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'dior'        
        }
    },
    {
        id: 18,
        name: 'Bộ thun nam, Bộ hè nam DIOR Nhí HOT HIT, Chất thun co dãn 4 chiều',
        price: 1200000,
        quantitySold: 10,
        image: 'https://down-vn.img.susercontent.com/file/sg-11134201-23010-14mm2e0998lvbf',
        nature: {
            color: ['white', 'black'],
            size: ['S', 'M', 'L'],
            type:'dior'        
        }
    }, 
];

var productContainer = document.querySelector('.home-product');
// Danh sách sản phẩm khi chưa được lọc
var productFilter = listProducts;
// Khởi tạo item và show nó ra HTML
function showProduct(productFilter) {
    productContainer.innerHTML = '';
    var gridRow = document.createElement('div');
    gridRow.classList.add('grid__row');
    productContainer.appendChild(gridRow);
    
    productFilter.forEach(function (item) {
        // Responsive
        var gridColumn = document.createElement('div');
        gridColumn.classList.add('grid__2-10-column');
        gridRow.appendChild(gridColumn);
        // Item
        var newItem = document.createElement('div');
        newItem.classList.add('home-product-item');
        gridColumn.appendChild(newItem);
        // Create Img
        var imageContainer = document.createElement('div');
        imageContainer.classList.add('home-product-item__img');
        imageContainer.setAttribute('style', "background-image: url("+ item.image +")");
        imageContainer.innerHTML = 
        `<div class="home-product-item__freeship">
            <span class="home-product-item__freeship-label">Freeship</span>
            <i class="home-product-item__freeship-icon fa-solid fa-bolt"></i>
        </div>`;
        newItem.appendChild(imageContainer);
        // Create name product
        var nameProduct = document.createElement('h4');
        nameProduct.classList.add('home-product-item__name');
        nameProduct.innerText = item.name;
        newItem.appendChild(nameProduct);
        // Create price
        var priceProduct = document.createElement('div');
        priceProduct.classList.add('home-product-item__price');
        priceProduct.innerHTML = 
        `<span class="home-product-item__price-old">${(item.price + 300000).toLocaleString() + ' đ'}</span>
        <span class="home-product-item__price-current">${item.price.toLocaleString() + ' đ'}</span>`;
        // priceProduct.innerText = item.price.toLocaleString() + ' đ';
        newItem.appendChild(priceProduct);
        // Create interact
        var interactProduct = document.createElement('div');
        interactProduct.classList.add('home-product-item__interact');
        interactProduct.innerHTML = 
        `<span class="home-product-item__like">
        <i class="home-product-item__like-icon-empty fa-regular fa-heart"></i>
        <i class="home-product-item__like-icon-fill fa-solid fa-heart"></i>
        </span>
        <span class="home-product-item__sold">Đã bán 
            <span class="quantity-Sold">${item.quantitySold}</span>
        </span>
        <div class="home-product-item__rating">
        <i class="fa-solid fa-star"></i>
        <i class="fa-solid fa-star"></i>
        <i class="fa-solid fa-star"></i>
        <i class="fa-solid fa-star"></i>
        <i class="fa-solid fa-star"></i>
        </div>`;
        newItem.appendChild(interactProduct);
        // Create favorite
        var labelProduct = document.createElement('div');
        labelProduct.classList.add('home-product-item__favorite');
        labelProduct.innerHTML = 
        `<i class="fa-solid fa-check"></i>
        <span>Yêu thích</span>`;
        newItem.appendChild(labelProduct);
    });
   
};
// Sắp xếp theo số lượng giảm giần 
productFilter.sort(function (a, b) {
    return b.quantitySold - a.quantitySold;
});
showProduct(productFilter);

// EventListener
var categoryList = document.querySelector('.category__list');
categoryList.addEventListener('click', function (e) {
    e.preventDefault();
    var valueFilter = e.target;
    productFilter = listProducts.filter(function (item) {
        // type Product
        if (valueFilter.type != '') {
            if (item.nature.type != valueFilter.type) {
                return false;
            }
        }
        // Best Seller
        if (valueFilter.value == 50) {
            if (item.quantitySold < valueFilter.value) {
                return false;
            }
        }
        return true;
    });
    showProduct(productFilter);

    /**
     * Pagination
     */
    var totalProducts = document.querySelectorAll('.home-product-item');
    console.log(totalProducts)
    var thisPage = 1;
    var limit = 15;
    function loadItem () {
        var beginGet = limit * (thisPage - 1);
        var endGet = limit * thisPage - 1;
        Array.from(totalProducts).forEach(function (item, index) {
            if (index >= beginGet && index <= endGet) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }      
        });
        // Callback đẻ gán lại i cho thisPage
        // i = 2 thì thisPage = 2
        listPage();
    };
    loadItem();

    function listPage () {
        // Math.cell(); làm tròn trên
        var totalPage = Math.ceil(totalProducts.length / limit);
        var listPage = document.querySelector('.pagination');
        listPage.innerHTML = '';
        // Move Page ở góc trên
        var movePage = document.querySelector('.home-filter-page__number');
        var movePageControl = document.querySelector('.home-filter-page__control');
        movePageControl.innerHTML = '';
        for (i = 1; i <= totalPage; i++) {
            var newPage = document.createElement('li');
            newPage.classList.add('pagination__item');
            newPage.setAttribute('onclick', "changePage("+ i +")");
            newPage.innerText = i;
            if (i == thisPage) {
                newPage.classList.add('pagination__item--active');
                // Move Page ở góc trên
                movePage.innerHTML = `<span class="home-filter-page__current">${i}</span>/${totalPage}`;
            }
            // Đưa list li vào trong ul
            listPage.appendChild(newPage);
        }
        // List Page: Previous Page
        var prevPage = document.createElement('li');
        prevPage.classList.add('pagination__item');
        prevPage.innerHTML = `<i class="fa-solid fa-chevron-left"></i>`;
        // Thêm li vào đầu ul
        listPage.insertBefore(prevPage, listPage.childNodes[0])
        prevPage.setAttribute('onclick', "changePage("+ (thisPage - 1) +")");
        
        // List Page: Next Page
        // var prevPageSmall = document.querySelector('.prev-page');
        // prevPageSmall.setAttribute('onclick', "changePage("+ (thisPage - 1) +")");
        var nextPage = document.createElement('li');
        nextPage.classList.add('pagination__item');
        nextPage.innerHTML = `<i class="fa-solid fa-chevron-right"></i>`;
        // Thêm li vào cuối ul
        listPage.insertBefore(nextPage, listPage.childNodes[totalPage + 1]);
        nextPage.setAttribute('onclick', "changePage("+ (thisPage + 1) +")");
    
        // Move Page: Prev Page góc ở trên
        var prevPageSmall = document.createElement('div');
        prevPageSmall.classList.add('home-filter-page__btn');
        prevPageSmall.innerHTML = '<i class="fa-solid fa-chevron-left"></i>';
        prevPageSmall.setAttribute('onclick', "changePage("+ (thisPage - 1) +")");
        movePageControl.appendChild(prevPageSmall);
        // Move Page: Next Page góc ở trên
        // var nextPageSmall = document.querySelector('.next-page');
        // nextPageSmall.setAttribute('onclick', "changePage("+ (thisPage + 1) +")");
        var nextPageSmall = document.createElement('div');
        nextPageSmall.classList.add('home-filter-page__btn');
        nextPageSmall.innerHTML = '<i class="fa-solid fa-chevron-right"></i>';
        nextPageSmall.setAttribute('onclick', "changePage("+ (thisPage + 1) +")");
        movePageControl.appendChild(nextPageSmall);
        
        // Disabled
        if (thisPage === 1) {
            prevPage.classList.add('pagination__item--disabled');
            prevPageSmall.classList.add('home-filter-page__btn--disabled');
        };
        if (thisPage === totalPage) {
            nextPage.classList.add('pagination__item--disabled');
            nextPageSmall.classList.add('home-filter-page__btn--disabled');
        }
    };
    function changePage (i) {
        // Gán i cho thisPage
        thisPage = i;
        loadItem();
    }
})

// EventListener
var filter = document.querySelector('.home-filter');
filter.addEventListener('click', function (e) {
    e.preventDefault();
    var valueFilter = e.target;
    // filter theo price
    if (valueFilter.innerText === 'Giá: Thấp đến Cao') {
        productFilter.sort(function (a, b) {
            return a.price - b.price;
        });
    }
    if (valueFilter.innerText === 'Giá: Cao đến Thấp') {
        productFilter.sort(function (a, b) {
            return b.price - a.price;
        });
    }
    // // filter newest Item
    // if (valueFilter.innerText === 'Mới Nhất') {
    //     // slice(): cắt và trả về 1 Array chứa các Element đã cắts
    //     productFilter= listProducts.reverse();
    // }
    showProduct(productFilter);
    
})
